
<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ABL case files</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
    <link rel="shortcut icon" href="_static/favicon.ico"/>
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="KTH Framework" href="framework.html" />
    <link rel="prev" title="snek5000-abl" href="README.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html" class="icon icon-home"> snek5000-abl
          </a>
              <div class="version">
                0.1.dev1+g65664f9
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
    
              <p class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="README.html">snek5000-abl</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">User Guide</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">ABL case files</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#boundary-conditions">Boundary conditions</a></li>
<li class="toctree-l2"><a class="reference internal" href="#forcing">Forcing</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="framework.html">KTH Framework</a></li>
<li class="toctree-l1"><a class="reference internal" href="nek5000.html">Nek5000 core library</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="_generated/abl.html">abl</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Help &amp; Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="roadmap.html">Roadmap</a></li>
<li class="toctree-l1"><a class="reference internal" href="boundary_cond.html">Boundary condition</a></li>
<li class="toctree-l1"><a class="reference internal" href="boundary_cond.html#faq">FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="filtering.html">Filtering</a></li>
<li class="toctree-l1"><a class="reference internal" href="CONTRIBUTING.html">Developer guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="CHANGELOG.html">Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="license.html">License</a></li>
</ul>


    
        <p class="caption">
            <span class="caption-text">
            
                Links
            
            </span>
        </p>
        <ul>
            
                
                    <li class="toctree-l1"><a href="https://exabl.github.io/snek5000-abl/doxygen/modules"><i class="fa fa-book fa-fw"></i> Fortran docs</a></li>
                
            
                
                    <li class="toctree-l1"><a href="https://github.com/exabl/snek5000-abl"><i class="fa fa-code fa-fw"></i> Source code</a></li>
                
            
                
                    <li class="toctree-l1"><a href="https://github.com/exabl/snek5000-abl/issues"><i class="fa fa-bug fa-fw"></i> Issue tracker</a></li>
                
            
        </ul>
    


        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">snek5000-abl</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
      <li>ABL case files</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/abl.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="abl-case-files">
<h1>ABL case files<a class="headerlink" href="#abl-case-files" title="Permalink to this headline"></a></h1>
<dl>
<dt class="sig sig-object cpp">
<span class="target" id="group__abl"></span><em><span class="pre">group</span></em> <span class="sig-name descname"><span class="pre">abl</span></span></dt>
<dd><p>Contains: user specified routines for the ABL case. </p>
<p><ul class="simple">
<li><p><a class="reference internal" href="#group__abl_1ga32657b69f54f96dc5aea199db3658bc3"><span class="std std-ref">uservp()</span></a> : variable properties</p></li>
<li><p><a class="reference internal" href="#group__abl_1ga1172abb68180ad165a8080d73ee2a378"><span class="std std-ref">userf()</span></a> : local acceleration term for fluid</p></li>
<li><p><a class="reference internal" href="#group__abl_1ga79dd81f06a46a7f8a1637ec998781930"><span class="std std-ref">userq()</span></a> : local source term for scalars</p></li>
<li><p><a class="reference internal" href="#group__abl_1ga5bc9a35082ab7f7115cd6ba8685682fd"><span class="std std-ref">userbc()</span></a> : boundary conditions</p></li>
<li><p><a class="reference internal" href="#group__abl_1ga9fca046e76d53cec863a2ef596ded5d8"><span class="std std-ref">useric()</span></a> : initial conditions</p></li>
<li><p><a class="reference internal" href="#group__abl_1gaab7e65383186bbbe5e8ee746f763b233"><span class="std std-ref">userchk()</span></a> : general purpose routine for checking errors etc.</p></li>
<li><p><a class="reference internal" href="#group__abl_1gac0c73a81b4be0f60b83a1f188bd8be50"><span class="std std-ref">userqtl()</span></a> : thermal divergence for lowMach number flows</p></li>
<li><p><a class="reference internal" href="#group__abl_1ga684b0320d82a6ae155bf7e0b53826cd3"><span class="std std-ref">usrdat()</span></a> : modify element vertices</p></li>
<li><p><a class="reference internal" href="#group__abl_1gad0bac908131bab7fa82d65be4229e976"><span class="std std-ref">usrdat2()</span></a> : modify mesh coordinates</p></li>
<li><p><a class="reference internal" href="#group__abl_1gae8e951758ca4752cd88bc9c5330c9ebe"><span class="std std-ref">usrdat3()</span></a> : general purpose routine for initialization </p></li>
</ul>
</p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-functions">Functions</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv46uservp2ix2iy2iz3ieg">
<span id="_CPPv36uservp2ix2iy2iz3ieg"></span><span id="_CPPv26uservp2ix2iy2iz3ieg"></span><span id="uservp__ix.iy.iz.ieg"></span><span class="target" id="group__abl_1ga32657b69f54f96dc5aea199db3658bc3"></span><span class="n"><span class="pre">subroutine</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">uservp</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv46uservp2ix2iy2iz3ieg" title="uservp::ix"><span class="n"><span class="pre">ix</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">ix</span></span>, <a class="reference internal" href="#_CPPv46uservp2ix2iy2iz3ieg" title="uservp::iy"><span class="n"><span class="pre">iy</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">iy</span></span>, <a class="reference internal" href="#_CPPv46uservp2ix2iy2iz3ieg" title="uservp::iz"><span class="n"><span class="pre">iz</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">iz</span></span>, <a class="reference internal" href="#_CPPv46uservp2ix2iy2iz3ieg" title="uservp::ieg"><span class="n"><span class="pre">ieg</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">ieg</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv46uservp2ix2iy2iz3ieg" title="Permalink to this definition"></a><br /></dt>
<dd><p>Set variable properties, does not call any subroutines / functions. </p>
<p><dl>
<dt class="sig sig-object cpp">
<em><span class="pre">Todo:</span></em></dt>
<dd><p>Implement turbulent Prandtl number parameter </p>
</dd></dl>

</p>
<dl class="field-list simple">
<dt class="field-odd">param ix</dt>
<dd class="field-odd"><p>x-index </p>
</dd>
<dt class="field-even">param iy</dt>
<dd class="field-even"><p>y-index </p>
</dd>
<dt class="field-odd">param iz</dt>
<dd class="field-odd"><p>z-index </p>
</dd>
<dt class="field-even">param ieg</dt>
<dd class="field-even"><p>element index </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv45userf2ix2iy2iz2eg">
<span id="_CPPv35userf2ix2iy2iz2eg"></span><span id="_CPPv25userf2ix2iy2iz2eg"></span><span id="userf__ix.iy.iz.eg"></span><span class="target" id="group__abl_1ga1172abb68180ad165a8080d73ee2a378"></span><span class="n"><span class="pre">subroutine</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">userf</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv45userf2ix2iy2iz2eg" title="userf::ix"><span class="n"><span class="pre">ix</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">ix</span></span>, <a class="reference internal" href="#_CPPv45userf2ix2iy2iz2eg" title="userf::iy"><span class="n"><span class="pre">iy</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">iy</span></span>, <a class="reference internal" href="#_CPPv45userf2ix2iy2iz2eg" title="userf::iz"><span class="n"><span class="pre">iz</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">iz</span></span>, <a class="reference internal" href="#_CPPv45userf2ix2iy2iz2eg" title="userf::eg"><span class="n"><span class="pre">eg</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">eg</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv45userf2ix2iy2iz2eg" title="Permalink to this definition"></a><br /></dt>
<dd><p>Compute Coriolis acceleration. </p>
<p><div class="math notranslate nohighlight">
\[ F_x, F_z = - f\hat{e}_y \times \vec{u} \]</div>
 See <a class="reference external" href="https://lists.mcs.anl.gov/pipermail/nek5000-users/2014-May/002798.html">https://lists.mcs.anl.gov/pipermail/nek5000-users/2014-May/002798.html</a> </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The Coroiolis acceleration also absorbs the part of the pressure under hydrostatic balance, which in turn drives the flow. When it is turned off, <a class="reference internal" href="#group__abl_1gae8e951758ca4752cd88bc9c5330c9ebe"><span class="std std-ref">usrdat3()</span></a> drives the flow. </p>
</div>
<dl class="field-list simple">
<dt class="field-odd">param ix, iy, iz</dt>
<dd class="field-odd"><p><strong>[in]</strong> GLL point index </p>
</dd>
<dt class="field-even">param eg</dt>
<dd class="field-even"><p><strong>[in]</strong> global element number </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv45userq2ix2iy2iz2eg">
<span id="_CPPv35userq2ix2iy2iz2eg"></span><span id="_CPPv25userq2ix2iy2iz2eg"></span><span id="userq__ix.iy.iz.eg"></span><span class="target" id="group__abl_1ga79dd81f06a46a7f8a1637ec998781930"></span><span class="n"><span class="pre">subroutine</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">userq</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv45userq2ix2iy2iz2eg" title="userq::ix"><span class="n"><span class="pre">ix</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">ix</span></span>, <a class="reference internal" href="#_CPPv45userq2ix2iy2iz2eg" title="userq::iy"><span class="n"><span class="pre">iy</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">iy</span></span>, <a class="reference internal" href="#_CPPv45userq2ix2iy2iz2eg" title="userq::iz"><span class="n"><span class="pre">iz</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">iz</span></span>, <a class="reference internal" href="#_CPPv45userq2ix2iy2iz2eg" title="userq::eg"><span class="n"><span class="pre">eg</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">eg</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv45userq2ix2iy2iz2eg" title="Permalink to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv46useric2ix2iy2iz2eg">
<span id="_CPPv36useric2ix2iy2iz2eg"></span><span id="_CPPv26useric2ix2iy2iz2eg"></span><span id="useric__ix.iy.iz.eg"></span><span class="target" id="group__abl_1ga9fca046e76d53cec863a2ef596ded5d8"></span><span class="n"><span class="pre">subroutine</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">useric</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv46useric2ix2iy2iz2eg" title="useric::ix"><span class="n"><span class="pre">ix</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">ix</span></span>, <a class="reference internal" href="#_CPPv46useric2ix2iy2iz2eg" title="useric::iy"><span class="n"><span class="pre">iy</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">iy</span></span>, <a class="reference internal" href="#_CPPv46useric2ix2iy2iz2eg" title="useric::iz"><span class="n"><span class="pre">iz</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">iz</span></span>, <a class="reference internal" href="#_CPPv46useric2ix2iy2iz2eg" title="useric::eg"><span class="n"><span class="pre">eg</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">eg</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv46useric2ix2iy2iz2eg" title="Permalink to this definition"></a><br /></dt>
<dd><p>Set up initial conditions. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv46userbc2ix2iy2iz5iside2eg">
<span id="_CPPv36userbc2ix2iy2iz5iside2eg"></span><span id="_CPPv26userbc2ix2iy2iz5iside2eg"></span><span id="userbc__ix.iy.iz.iside.eg"></span><span class="target" id="group__abl_1ga5bc9a35082ab7f7115cd6ba8685682fd"></span><span class="n"><span class="pre">subroutine</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">userbc</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv46userbc2ix2iy2iz5iside2eg" title="userbc::ix"><span class="n"><span class="pre">ix</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">ix</span></span>, <a class="reference internal" href="#_CPPv46userbc2ix2iy2iz5iside2eg" title="userbc::iy"><span class="n"><span class="pre">iy</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">iy</span></span>, <a class="reference internal" href="#_CPPv46userbc2ix2iy2iz5iside2eg" title="userbc::iz"><span class="n"><span class="pre">iz</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">iz</span></span>, <a class="reference internal" href="#_CPPv46userbc2ix2iy2iz5iside2eg" title="userbc::iside"><span class="n"><span class="pre">iside</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">iside</span></span>, <a class="reference internal" href="#_CPPv46userbc2ix2iy2iz5iside2eg" title="userbc::eg"><span class="n"><span class="pre">eg</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">eg</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv46userbc2ix2iy2iz5iside2eg" title="Permalink to this definition"></a><br /></dt>
<dd><p>Compute the boundary condition. See subdirectory bc/. </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>it is OK to define both flux and temp here since only one would be used at the same time. See BCNEUSC(), BCDIRSC() and FACEIS() </p>
</div>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv47userchkv">
<span id="_CPPv37userchkv"></span><span id="_CPPv27userchkv"></span><span id="userchk"></span><span class="target" id="group__abl_1gaab7e65383186bbbe5e8ee746f763b233"></span><span class="n"><span class="pre">subroutine</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">userchk</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv47userchkv" title="Permalink to this definition"></a><br /></dt>
<dd><p>Compute the turbulent stress tensors and write statistics. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv47userqtlv">
<span id="_CPPv37userqtlv"></span><span id="_CPPv27userqtlv"></span><span id="userqtl"></span><span class="target" id="group__abl_1gac0c73a81b4be0f60b83a1f188bd8be50"></span><span class="n"><span class="pre">subroutine</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">userqtl</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv47userqtlv" title="Permalink to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv46usrdatv">
<span id="_CPPv36usrdatv"></span><span id="_CPPv26usrdatv"></span><span id="usrdat"></span><span class="target" id="group__abl_1ga684b0320d82a6ae155bf7e0b53826cd3"></span><span class="n"><span class="pre">subroutine</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">usrdat</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv46usrdatv" title="Permalink to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv47usrdat2v">
<span id="_CPPv37usrdat2v"></span><span id="_CPPv27usrdat2v"></span><span id="usrdat2"></span><span class="target" id="group__abl_1gad0bac908131bab7fa82d65be4229e976"></span><span class="n"><span class="pre">subroutine</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">usrdat2</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv47usrdat2v" title="Permalink to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv47usrdat3v">
<span id="_CPPv37usrdat3v"></span><span id="_CPPv27usrdat3v"></span><span id="usrdat3"></span><span class="target" id="group__abl_1gae8e951758ca4752cd88bc9c5330c9ebe"></span><span class="n"><span class="pre">subroutine</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">usrdat3</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv47usrdat3v" title="Permalink to this definition"></a><br /></dt>
<dd><p>Compute inflow / outflow conditions a.k.a. driving force. Ubar=1 Not required when coriolis force is specified in userf. </p>
<p><dl class="simple">
<dt><strong>See</strong></dt><dd><p><a class="reference external" href="https://github.com/Nek5000/NekExamples/blob/70a5792b04b7a4c2da16463f517863b10627398f/turbChannel/turbChannel.usr#L375-L386">https://github.com/Nek5000/NekExamples/blob/70a5792b04b7a4c2da16463f517863b10627398f/turbChannel/turbChannel.usr#L375-L386</a> </p>
</dd>
</dl>
</p>
</dd></dl>

</div>
</dd></dl>

<section id="boundary-conditions">
<h2>Boundary conditions<a class="headerlink" href="#boundary-conditions" title="Permalink to this headline"></a></h2>
<dl>
<dt class="sig sig-object cpp">
<span class="target" id="group__bc__moeng"></span><em><span class="pre">group</span></em> <span class="sig-name descname"><span class="pre">bc_moeng</span></span></dt>
<dd><div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-functions">Functions</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv410abl_userbc2ix2iy2iz5iside2eg">
<span id="_CPPv310abl_userbc2ix2iy2iz5iside2eg"></span><span id="_CPPv210abl_userbc2ix2iy2iz5iside2eg"></span><span id="abl_userbc__ix.iy.iz.iside.eg"></span><span class="target" id="group__bc__moeng_1ga7ce4720eca38e4ff768aa26217859d45"></span><span class="n"><span class="pre">subroutine</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">abl_userbc</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv410abl_userbc2ix2iy2iz5iside2eg" title="abl_userbc::ix"><span class="n"><span class="pre">ix</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">ix</span></span>, <a class="reference internal" href="#_CPPv410abl_userbc2ix2iy2iz5iside2eg" title="abl_userbc::iy"><span class="n"><span class="pre">iy</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">iy</span></span>, <a class="reference internal" href="#_CPPv410abl_userbc2ix2iy2iz5iside2eg" title="abl_userbc::iz"><span class="n"><span class="pre">iz</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">iz</span></span>, <a class="reference internal" href="#_CPPv410abl_userbc2ix2iy2iz5iside2eg" title="abl_userbc::iside"><span class="n"><span class="pre">iside</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">iside</span></span>, <a class="reference internal" href="#_CPPv410abl_userbc2ix2iy2iz5iside2eg" title="abl_userbc::eg"><span class="n"><span class="pre">eg</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">eg</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv410abl_userbc2ix2iy2iz5iside2eg" title="Permalink to this definition"></a><br /></dt>
<dd><p>Stress boundary condition as formulated by Moeng (1984) Also has optional temporal filtering c.f: Yang et al. Physical Review Fluids 2, no. 10 (2017): 104601. </p>
<p><dl class="simple">
<dt><strong>See</strong></dt><dd><p><a class="reference external" href="https://journals.ametsoc.org/doi/abs/10.1175/1520-0469(1984)041%3C2052:ALESMF%3E2.0.CO%3B2">https://journals.ametsoc.org/doi/abs/10.1175/1520-0469(1984)041%3C2052:ALESMF%3E2.0.CO%3B2</a> </p>
</dd>
<dt><strong>See</strong></dt><dd><p><a class="reference external" href="https://doi.org/10.1103/PhysRevFluids.2.104601">https://doi.org/10.1103/PhysRevFluids.2.104601</a>.</p>
</dd>
</dl>
</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Boundary condition evaluated at higher nodes, may need to be corrected for Ekmann turning </p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This subroutine MAY NOT be called by every process </p>
</div>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp">
<span class="target" id="group__bc__moeng_1ga0fd125185c648c62582c12219748aa2b"></span><span class="sig-name descname"><span class="pre">real</span> <span class="pre">function</span> <span class="pre">friction_vel(uh</span> <span class="pre">uh,</span> <span class="pre">kappa</span> <span class="pre">kappa,</span> <span class="pre">delta_z</span> <span class="pre">delta_z,</span> <span class="pre">z0</span> <span class="pre">z0,</span> <span class="pre">Psi_M</span> <span class="pre">Psi_M)</span></span></dt>
<dd><p>Compute friction velocity. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp">
<span class="target" id="group__bc__moeng_1ga12690b51fbb6cd5fc0d67e802741330d"></span><span class="sig-name descname"><span class="pre">real</span> <span class="pre">function</span> <span class="pre">thermal_flux(u_star</span> <span class="pre">u_star,</span> <span class="pre">kappa</span> <span class="pre">kappa,</span> <span class="pre">T_surf</span> <span class="pre">T_surf,</span> <span class="pre">T</span> <span class="pre">T,</span> <span class="pre">delta_z</span> <span class="pre">delta_z,</span> <span class="pre">z_os</span> <span class="pre">z_os,</span> <span class="pre">Psi_H</span> <span class="pre">Psi_H)</span></span></dt>
<dd><p>Complute thermal flux. </p>
<p><dl class="simple">
<dt><strong>See</strong></dt><dd><p>Eq. 14 in Gadde et al. (2020) doi:10.1007/s10546-020-00570-5 </p>
</dd>
</dl>
</p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp">
<span class="target" id="group__bc__moeng_1ga1e151624fb337cc548e930ba9ffee688"></span><span class="sig-name descname"><span class="pre">real</span> <span class="pre">function</span> <span class="pre">thermal_flux_fixed(x</span> <span class="pre">x)</span></span></dt>
<dd><p>Set thermal flux which varies along x, but is constant in time. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp">
<span class="target" id="group__bc__moeng_1ga53ce0c5748e061e976a8fc2563998d25"></span><span class="sig-name descname"><span class="pre">real</span> <span class="pre">function</span> <span class="pre">temp_strat(t_surf</span> <span class="pre">t_surf,</span> <span class="pre">y</span> <span class="pre">y,</span> <span class="pre">half_ymax</span> <span class="pre">half_ymax)</span></span></dt>
<dd><p>Set temperature dirichlet boundary conditions at bottom and top boundaries. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp">
<span class="target" id="group__bc__moeng_1ga254f23587dbb1681663a4611ef44bef4"></span><span class="sig-name descname"><span class="pre">real</span> <span class="pre">function</span> <span class="pre">abl_pen_k(y_coord</span> <span class="pre">y_coord,</span> <span class="pre">z0</span> <span class="pre">z0)</span></span></dt>
<dd><p>Compute the K term in penalty forcing. </p>
<dl class="field-list simple">
<dt class="field-odd">param y_coord</dt>
<dd class="field-odd"><p>mesh coordinate where the coefficient is evaluated </p>
</dd>
<dt class="field-even">param z0</dt>
<dd class="field-even"><p>roughness length </p>
</dd>
</dl>
</dd></dl>

</div>
</dd></dl>

<dl>
<dt class="sig sig-object cpp">
<span class="target" id="group__bc__channel"></span><em><span class="pre">group</span></em> <span class="sig-name descname"><span class="pre">bc_channel</span></span></dt>
<dd><p>Variant of <a class="reference internal" href="#group__bc__moeng"><span class="std std-ref">Moeng boundary condition</span></a> which also allows to have a wall function at the top boundary. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-functions">Functions</p>
<dl class="cpp function">
<dt class="sig sig-object cpp">
<span class="target" id="group__bc__channel_1ga7ce4720eca38e4ff768aa26217859d45"></span><span class="n"><span class="pre">subroutine</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">abl_userbc</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv410abl_userbc2ix2iy2iz5iside2eg" title="abl_userbc::ix"><span class="n"><span class="pre">ix</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">ix</span></span>, <a class="reference internal" href="#_CPPv410abl_userbc2ix2iy2iz5iside2eg" title="abl_userbc::iy"><span class="n"><span class="pre">iy</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">iy</span></span>, <a class="reference internal" href="#_CPPv410abl_userbc2ix2iy2iz5iside2eg" title="abl_userbc::iz"><span class="n"><span class="pre">iz</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">iz</span></span>, <a class="reference internal" href="#_CPPv410abl_userbc2ix2iy2iz5iside2eg" title="abl_userbc::iside"><span class="n"><span class="pre">iside</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">iside</span></span>, <a class="reference internal" href="#_CPPv410abl_userbc2ix2iy2iz5iside2eg" title="abl_userbc::eg"><span class="n"><span class="pre">eg</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">eg</span></span><span class="sig-paren">)</span><br /></dt>
<dd><p>Stress boundary condition as formulated by Moeng (1984) Also has optional temporal filtering c.f: Yang et al. Physical Review Fluids 2, no. 10 (2017): 104601. <a class="reference external" href="https://doi.org/10.1103/PhysRevFluids.2.104601">https://doi.org/10.1103/PhysRevFluids.2.104601</a>. </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Boundary condition evaluated at higher nodes, may need to be corrected for Ekmann turning </p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This subroutine MAY NOT be called by every process </p>
</div>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp">
<span class="target" id="group__bc__channel_1ga254f23587dbb1681663a4611ef44bef4"></span><span class="sig-name descname"><span class="pre">real</span> <span class="pre">function</span> <span class="pre">abl_pen_k(y_coord</span> <span class="pre">y_coord,</span> <span class="pre">z0</span> <span class="pre">z0)</span></span></dt>
<dd><p>Compute the K term in penalty forcing. </p>
<dl class="field-list simple">
<dt class="field-odd">param y_coord</dt>
<dd class="field-odd"><p>mesh coordinate where the coefficient is evaluated </p>
</dd>
<dt class="field-even">param z0</dt>
<dd class="field-even"><p>roughness length </p>
</dd>
</dl>
</dd></dl>

</div>
</dd></dl>

<dl>
<dt class="sig sig-object cpp">
<span class="target" id="group__bc__noslip"></span><em><span class="pre">group</span></em> <span class="sig-name descname"><span class="pre">bc_noslip</span></span></dt>
<dd><div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-functions">Functions</p>
<dl class="cpp function">
<dt class="sig sig-object cpp">
<span class="target" id="group__bc__noslip_1ga7ce4720eca38e4ff768aa26217859d45"></span><span class="n"><span class="pre">subroutine</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">abl_userbc</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv410abl_userbc2ix2iy2iz5iside2eg" title="abl_userbc::ix"><span class="n"><span class="pre">ix</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">ix</span></span>, <a class="reference internal" href="#_CPPv410abl_userbc2ix2iy2iz5iside2eg" title="abl_userbc::iy"><span class="n"><span class="pre">iy</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">iy</span></span>, <a class="reference internal" href="#_CPPv410abl_userbc2ix2iy2iz5iside2eg" title="abl_userbc::iz"><span class="n"><span class="pre">iz</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">iz</span></span>, <a class="reference internal" href="#_CPPv410abl_userbc2ix2iy2iz5iside2eg" title="abl_userbc::iside"><span class="n"><span class="pre">iside</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">iside</span></span>, <a class="reference internal" href="#_CPPv410abl_userbc2ix2iy2iz5iside2eg" title="abl_userbc::eg"><span class="n"><span class="pre">eg</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">eg</span></span><span class="sig-paren">)</span><br /></dt>
<dd><p>No slip and no penetration condition. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp">
<span class="target" id="group__bc__noslip_1ga254f23587dbb1681663a4611ef44bef4"></span><span class="sig-name descname"><span class="pre">real</span> <span class="pre">function</span> <span class="pre">abl_pen_k(y_coord</span> <span class="pre">y_coord,</span> <span class="pre">z0</span> <span class="pre">z0)</span></span></dt>
<dd><p>Compute the K term in penalty forcing. </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Be careful in specifying the penalty region, should be away from the wall </p>
</div>
<dl class="field-list simple">
<dt class="field-odd">param y_coord</dt>
<dd class="field-odd"><p>mesh coordinate where the coefficient is evaluated </p>
</dd>
<dt class="field-even">param z0</dt>
<dd class="field-even"><p>roughness length </p>
</dd>
</dl>
</dd></dl>

</div>
</dd></dl>

</section>
<section id="forcing">
<h2>Forcing<a class="headerlink" href="#forcing" title="Permalink to this headline"></a></h2>
<dl>
<dt class="sig sig-object cpp">
<span class="target" id="group__penalty__mini"></span><em><span class="pre">group</span></em> <span class="sig-name descname"><span class="pre">penalty_mini</span></span></dt>
<dd><p>A BC which appears as a/forcing”: the mini version. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-functions">Functions</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv410pen_updatev">
<span id="_CPPv310pen_updatev"></span><span id="_CPPv210pen_updatev"></span><span id="pen_update"></span><span class="target" id="group__penalty__mini_1gaad698038b43804d17a718e007d0dd8a9"></span><span class="n"><span class="pre">subroutine</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">pen_update</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv410pen_updatev" title="Permalink to this definition"></a><br /></dt>
<dd><p>Update penalty. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv411pen_forcing2ix2iy2iz3ieg">
<span id="_CPPv311pen_forcing2ix2iy2iz3ieg"></span><span id="_CPPv211pen_forcing2ix2iy2iz3ieg"></span><span id="pen_forcing__ix.iy.iz.ieg"></span><span class="target" id="group__penalty__mini_1gab29eabec41313b420926002af9f747f0"></span><span class="n"><span class="pre">subroutine</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">pen_forcing</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv411pen_forcing2ix2iy2iz3ieg" title="pen_forcing::ix"><span class="n"><span class="pre">ix</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">ix</span></span>, <a class="reference internal" href="#_CPPv411pen_forcing2ix2iy2iz3ieg" title="pen_forcing::iy"><span class="n"><span class="pre">iy</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">iy</span></span>, <a class="reference internal" href="#_CPPv411pen_forcing2ix2iy2iz3ieg" title="pen_forcing::iz"><span class="n"><span class="pre">iz</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">iz</span></span>, <a class="reference internal" href="#_CPPv411pen_forcing2ix2iy2iz3ieg" title="pen_forcing::ieg"><span class="n"><span class="pre">ieg</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">ieg</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv411pen_forcing2ix2iy2iz3ieg" title="Permalink to this definition"></a><br /></dt>
<dd><p>Compute penalty forcing. </p>
<p><dl>
<dt class="sig sig-object cpp">
<em><span class="pre">Todo:</span></em></dt>
<dd><p>add ffy component and rotation</p>
</dd></dl>

</p>
<dl class="field-list simple">
<dt class="field-odd">param ffx, ffy, ffz</dt>
<dd class="field-odd"><p><strong>[inout]</strong> forcing; x,y,z component </p>
</dd>
<dt class="field-even">param ix, iy, iz</dt>
<dd class="field-even"><p><strong>[in]</strong> GLL point index </p>
</dd>
<dt class="field-odd">param ieg</dt>
<dd class="field-odd"><p><strong>[in]</strong> global element number </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv413pen_fmask_getv">
<span id="_CPPv313pen_fmask_getv"></span><span id="_CPPv213pen_fmask_getv"></span><span id="pen_fmask_get"></span><span class="target" id="group__penalty__mini_1gaa48126191ec24c4aa1d1158d48a4a525"></span><span class="n"><span class="pre">subroutine</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">pen_fmask_get</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv413pen_fmask_getv" title="Permalink to this definition"></a><br /></dt>
<dd><p>Get 1D projection, array mapping and forcing smoothing. </p>
<p>This routine is just a simple version supporting only lines paralles to z axis. In future it can be generalised. The subroutine initializes pen_prj, pen_map and pen_npoint <dl class="simple">
<dt><strong>See</strong></dt><dd><p>Schlatter and Örlü, “Turbulent Boundary Layers at Moderate Reynolds Numbers.” pg. 12 </p>
</dd>
<dt><strong>Remark</strong></dt><dd><p>This routine uses global scratch space <em>CTMP0</em> and <em>CTMP1</em> </p>
</dd>
</dl>
</p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv414pen_fterms_get7ifreset">
<span id="_CPPv314pen_fterms_get7ifreset"></span><span id="_CPPv214pen_fterms_get7ifreset"></span><span id="pen_fterms_get__ifreset"></span><span class="target" id="group__penalty__mini_1ga0aa813592cb2c1cb049ab22531179489"></span><span class="n"><span class="pre">subroutine</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">pen_fterms_get</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv414pen_fterms_get7ifreset" title="pen_fterms_get::ifreset"><span class="n"><span class="pre">ifreset</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">ifreset</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv414pen_fterms_get7ifreset" title="Permalink to this definition"></a><br /></dt>
<dd><p>Generate forcing terms: pen_k_len and pen_fstab. </p>
<p>This used to also initializes the pen_famp array. This was to allow for spatio-temporally varying forcing, which has been removed in this version.</p>
<dl class="field-list simple">
<dt class="field-odd">param ifreset</dt>
<dd class="field-odd"><p><strong>[in]</strong> reset flag to reinitialize geometry term pen_k_len </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv412pen_registerv">
<span id="_CPPv312pen_registerv"></span><span id="_CPPv212pen_registerv"></span><span id="pen_register"></span><span class="target" id="group__penalty__mini_1ga6eb01b9729b455f0f9c08b3560290493"></span><span class="n"><span class="pre">subroutine</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">pen_register</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv412pen_registerv" title="Permalink to this definition"></a><br /></dt>
<dd><p>Register penalty module. </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This routine should be called in frame_usr_register </p>
</div>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv48pen_initv">
<span id="_CPPv38pen_initv"></span><span id="_CPPv28pen_initv"></span><span id="pen_init"></span><span class="target" id="group__penalty__mini_1ga15121d5db02b3accc55625bb9893ddbe"></span><span class="n"><span class="pre">subroutine</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">pen_init</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv48pen_initv" title="Permalink to this definition"></a><br /></dt>
<dd><p>Initilise penalty module. </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This routine should be called in frame_usr_init </p>
</div>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp">
<span class="target" id="group__penalty__mini_1ga231bc69c8c491d64522bb1997a4a7960"></span><span class="sig-name descname"><span class="pre">logical</span> <span class="pre">function</span> <span class="pre">pen_is_initialised()</span></span></dt>
<dd><p>Check if module was initialised. </p>
<dl class="field-list simple">
<dt class="field-odd">return</dt>
<dd class="field-odd"><p>pen_is_initialised </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv413local_cart_dy2us1u1N1e2Dt">
<span id="_CPPv313local_cart_dy2us1u1N1e2Dt"></span><span id="_CPPv213local_cart_dy2us1u1N1e2Dt"></span><span id="local_cart_dy__us.u.N.e.Dt"></span><span class="target" id="group__penalty__mini_1ga0ce4b99b400fee68110bae64c6a6277c"></span><span class="n"><span class="pre">subroutine</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">local_cart_dy</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv413local_cart_dy2us1u1N1e2Dt" title="local_cart_dy::us"><span class="n"><span class="pre">us</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">us</span></span>, <a class="reference internal" href="#_CPPv413local_cart_dy2us1u1N1e2Dt" title="local_cart_dy::u"><span class="n"><span class="pre">u</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">u</span></span>, <a class="reference internal" href="#_CPPv413local_cart_dy2us1u1N1e2Dt" title="local_cart_dy::N"><span class="n"><span class="pre">N</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">N</span></span>, <a class="reference internal" href="#_CPPv413local_cart_dy2us1u1N1e2Dt" title="local_cart_dy::e"><span class="n"><span class="pre">e</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">e</span></span>, <a class="reference internal" href="#_CPPv413local_cart_dy2us1u1N1e2Dt" title="local_cart_dy::Dt"><span class="n"><span class="pre">Dt</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">Dt</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv413local_cart_dy2us1u1N1e2Dt" title="Permalink to this definition"></a><br /></dt>
<dd><p>Assuming the mesh is cartesian, compute exact y-derivative for an element, by operating. </p>
<p><div class="math notranslate nohighlight">
\[ \mathbf{u} D^T \]</div>
</p>
<dl class="field-list simple">
<dt class="field-odd">param us</dt>
<dd class="field-odd"><p><strong>[out]</strong> </p>
</dd>
<dt class="field-even">param u, N, e, Dt</dt>
<dd class="field-even"><p><strong>[in]</strong> </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv420local_cart_dy_pseudo2us1u1N1e2Dt">
<span id="_CPPv320local_cart_dy_pseudo2us1u1N1e2Dt"></span><span id="_CPPv220local_cart_dy_pseudo2us1u1N1e2Dt"></span><span id="local_cart_dy_pseudo__us.u.N.e.Dt"></span><span class="target" id="group__penalty__mini_1gaa8eaa7869bcd674f01457cb5dd2eb012"></span><span class="n"><span class="pre">subroutine</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">local_cart_dy_pseudo</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv420local_cart_dy_pseudo2us1u1N1e2Dt" title="local_cart_dy_pseudo::us"><span class="n"><span class="pre">us</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">us</span></span>, <a class="reference internal" href="#_CPPv420local_cart_dy_pseudo2us1u1N1e2Dt" title="local_cart_dy_pseudo::u"><span class="n"><span class="pre">u</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">u</span></span>, <a class="reference internal" href="#_CPPv420local_cart_dy_pseudo2us1u1N1e2Dt" title="local_cart_dy_pseudo::N"><span class="n"><span class="pre">N</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">N</span></span>, <a class="reference internal" href="#_CPPv420local_cart_dy_pseudo2us1u1N1e2Dt" title="local_cart_dy_pseudo::e"><span class="n"><span class="pre">e</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">e</span></span>, <a class="reference internal" href="#_CPPv420local_cart_dy_pseudo2us1u1N1e2Dt" title="local_cart_dy_pseudo::Dt"><span class="n"><span class="pre">Dt</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">Dt</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv420local_cart_dy_pseudo2us1u1N1e2Dt" title="Permalink to this definition"></a><br /></dt>
<dd><p>Assuming the mesh is cartesian, compute pseudo(?) y-derivative along y-axis for an element, by operating. </p>
<p><div class="math notranslate nohighlight">
\[ Dt \mathbf{u} \]</div>
</p>
<dl class="field-list simple">
<dt class="field-odd">param us</dt>
<dd class="field-odd"><p><strong>[out]</strong> </p>
</dd>
<dt class="field-even">param u, N, e, Dt</dt>
<dd class="field-even"><p><strong>[in]</strong> </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv411cart_diff_y2uy1u7ifexact">
<span id="_CPPv311cart_diff_y2uy1u7ifexact"></span><span id="_CPPv211cart_diff_y2uy1u7ifexact"></span><span id="cart_diff_y__uy.u.ifexact"></span><span class="target" id="group__penalty__mini_1ga689a6a1fa1bd03e4bd215f4877e5bd86"></span><span class="n"><span class="pre">subroutine</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">cart_diff_y</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv411cart_diff_y2uy1u7ifexact" title="cart_diff_y::uy"><span class="n"><span class="pre">uy</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">uy</span></span>, <a class="reference internal" href="#_CPPv411cart_diff_y2uy1u7ifexact" title="cart_diff_y::u"><span class="n"><span class="pre">u</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">u</span></span>, <a class="reference internal" href="#_CPPv411cart_diff_y2uy1u7ifexact" title="cart_diff_y::ifexact"><span class="n"><span class="pre">ifexact</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">ifexact</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv411cart_diff_y2uy1u7ifexact" title="Permalink to this definition"></a><br /></dt>
<dd></dd></dl>

</div>
</dd></dl>

</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="README.html" class="btn btn-neutral float-left" title="snek5000-abl" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="framework.html" class="btn btn-neutral float-right" title="KTH Framework" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2019 - 2022, Ashwin Vishnu Mohanan. Published: 2022-01-21.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>